## 概要
- ダッシュボードに「日別タスク」「月別タスク」をTODOリスト形式で表示し、チェックで完了状態を更新
- クライアントは React + MUI、データ取得は既存の `axios` と（あれば）`@tanstack/react-query` を活用
- サーバーは Express + SQLite に `tasks` テーブルを追加し、CRUD と期間別取得 API を提供

## 対象コード
- ダッシュボード: `client/src/pages/Dashboard.tsx`
- APIクライアント: `client/src/utils/apiClient.ts`
- サーバー起点/ルーター: `server/index.js`
- DBユーティリティ: `server/utils/db.js`
- 初期化/スキーマ: `server/init.js`

## データモデル（SQLite）
- 新規テーブル `tasks`
  - `id` INTEGER PRIMARY KEY
  - `type` TEXT（`daily` | `monthly`）
  - `title` TEXT（例: 前日まとめ、支払い）
  - `note` TEXT（任意メモ）
  - `date` TEXT（`YYYY-MM-DD`、`type=daily`の時に使用）
  - `month` TEXT（`YYYY-MM`、`type=monthly`の時に使用）
  - `due_time` TEXT（`HH:mm`、日別の「発注（何時まで）」用・任意）
  - `completed` INTEGER（0/1、既定0）
  - `order_index` INTEGER（任意、並び順）
  - `created_at`/`updated_at` TEXT（ISO文字列）
- インデックス: `(type, date)`, `(type, month)`
- 初期化: `server/init.js` に `CREATE TABLE IF NOT EXISTS tasks` を追加（既存DBでも安全）

## サーバーAPI設計（Express）
- 取得
  - `GET /api/tasks?type=daily&date=YYYY-MM-DD`
  - `GET /api/tasks?type=monthly&month=YYYY-MM`
- 追加
  - `POST /api/tasks`
  - ボディ: `{ type, title, note?, date?, month?, due_time?, order_index? }`
- 更新（部分更新）
  - `PATCH /api/tasks/:id`
  - ボディ例: `{ title?, note?, due_time?, completed?, order_index? }`
- 削除
  - `DELETE /api/tasks/:id`
- 実装方針
  - `server/routes/tasks.js` を追加し、`server/index.js` から `/api/tasks` にマウント
  - SQL は `server/utils/db.js` の `dbAll/dbGet/dbRun` を使用
  - バリデーションは既存パターンに合わせ、軽量チェック（型・必須項目）+ サニタイズ

## クライアントUI（Dashboard）
- 2つのカードを追加
  - 「日別タスク」: 今日（もしくは日付ピッカーで選択日）のタスクを表示
  - 「月別タスク」: 当月（または月ピッカー）タスクを表示
- 表示構成
  - MUI `Card` + `List` + `Checkbox` + `TextField` + `IconButton`（追加/削除/編集）
  - 未完了を上位、完了は下位に表示。完了は取り消し線と淡色
  - `due_time` がある場合はサブテキスト表示（例: 発注 15:00 まで）
- 操作
  - 追加: タイトル入力→Enter/追加ボタンで `POST /api/tasks`
  - 完了切替: チェックボックス→`PATCH /api/tasks/:id { completed }`
  - 編集: タイトル/メモ編集→`PATCH`
  - 削除: ゴミ箱アイコン→`DELETE`
- データ取得
  - `apiClient` で `GET /api/tasks` を呼び、必要なら `react-query` でキャッシュ・楽観更新

## ステート管理/UX
- フィルター
  - 日付ピッカー（`@mui/x-date-pickers`）で日別タスクの対象日を変更
  - 月ピッカーで月別タスク対象月を変更（`YYYY-MM`）
- 並び替え
  - `order_index` で並び順を維持、未指定は作成順
- 楽観更新
  - チェック操作は即時反映→API失敗時にロールバック
- エラーハンドリング
  - トースト/スナックバーで失敗を通知

## テスト/検証
- E2E（Playwright）
  - 日別タスク追加→一覧表示→チェックで完了→再取得で状態保持
  - 月別タスクの同様動作
  - 削除の確認
- サーバー単体
  - APIのhappy/edgeパス（無効パラメータ、存在しないIDの更新/削除）

## 移行・互換性
- 既存機能に影響しない独立テーブル
- `CREATE TABLE IF NOT EXISTS` で起動時自動作成
- KPI等既存ダッシュボードとのレイアウト整合性を保つ

## 作業ステップ
1. DBスキーマを `server/init.js` に追加
2. `server/routes/tasks.js` を実装し `/api/tasks` を公開
3. `client/src/pages/Dashboard.tsx` に「日別タスク」「月別タスク」カードを追加
4. `apiClient` + `react-query`（存在すれば）で取得/更新/追加/削除ロジック
5. Playwright でE2Eテストを追加し主要ユースケースを検証

## 補足
- 例の初期タスク（前日まとめ/リスト出力/ピッキング/発注、支払い/申請/会議）はUIから登録可能。必要ならサーバー起動時にデフォルト投入のオプションを用意可能